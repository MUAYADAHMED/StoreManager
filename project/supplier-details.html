<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ù…ÙˆØ±Ø¯ - Ø¯ÙØªØ± Ø­Ø³Ø§Ø¨Ø§Øª Ø§Ù„Ø¨ÙˆÙÙŠØ©</title>

  <!-- Tailwind -->
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- Icons -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/remixicon@3.5.0/fonts/remixicon.css" />

  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            primary: "#3B82F6",
            secondary: "#10B981",
          },
        },
      },
    };
  </script>

  <style>
    @import url("https://fonts.googleapis.com/css2?family=Tajawal:wght@300;400;500;700&display=swap");
    body { 
      font-family: "Tajawal", sans-serif; 
    }
    .content-area { 
      padding-bottom: 120px; 
    }
    .fab {
      position: fixed;
      bottom: 100px;
      left: 20px;
      z-index: 40;
    }
    .bottom-nav {
      position: fixed;
      bottom: 0;
      left: 0;
      right: 0;
      z-index: 30;
    }
    .loading-spinner {
      border: 3px solid #f3f3f3;
      border-top: 3px solid #3498db;
      border-radius: 50%;
      width: 40px;
      height: 40px;
      animation: spin 1s linear infinite;
      margin: 20px auto;
    }
    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
  </style>
</head>

<body class="bg-gray-50">

  <!-- HEADER -->
  <div class="bg-white shadow-sm px-4 py-3 flex items-center gap-3 sticky top-0 z-20">
    <button onclick="goBack()" class="w-10 h-10 flex items-center justify-center rounded-full bg-gray-100 hover:bg-gray-200">
      <i class="ri-arrow-right-line text-xl text-gray-700"></i>
    </button>

    <div>
      <h1 class="text-lg font-bold text-gray-800" id="supplier-name">Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...</h1>
      <p class="text-xs text-gray-500">ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø´Ø±Ø§Ø¡ ÙˆØ§Ù„Ø¯ÙØ¹</p>
    </div>
  </div>

  <main class="container mx-auto px-4 pt-6 content-area">
    <!-- Loading indicator -->
    <div id="loading-indicator" class="text-center py-10">
      <div class="loading-spinner"></div>
      <p class="text-gray-500 mt-2">Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…ÙˆØ±Ø¯...</p>
    </div>

    <!-- Content (hidden initially) -->
    <div id="content-area" class="hidden">
      <!-- SUPPLIER CARD -->
      <div class="bg-white p-5 rounded-xl shadow-sm border mb-6">
        <div class="flex items-center gap-6">

          <!-- AVATAR -->
          <div class="w-14 h-14 rounded-full bg-purple-600 flex items-center justify-center text-white text-2xl font-bold" id="supplier-avatar">
            Ù…
          </div>

          <div class="flex-1">
            <h2 class="font-bold text-xl text-gray-800" id="supplier-fullname">Ø§Ø³Ù… Ø§Ù„Ù…ÙˆØ±Ø¯</h2>
            <p class="text-gray-600 text-sm" id="supplier-phone">
              <i class="ri-phone-line text-gray-500"></i>
              Ø§Ù„Ù‡Ø§ØªÙ
            </p>

            <div class="mt-2 flex gap-6 text-sm">
              <p><span class="text-gray-500">Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø§Øª:</span> <span class="font-bold" id="transaction-count">0</span></p>
              <p><span class="text-gray-500">Ø¢Ø®Ø± Ù…Ø¹Ø§Ù…Ù„Ø©:</span> <span class="font-bold" id="last-transaction">--</span></p>
            </div>
          </div>
        </div>
      </div>

      <!-- SUPPLIER STATISTICS -->
      <div class="grid grid-cols-2 gap-4 mb-6">
        <!-- Amount We Owe -->
        <div class="bg-white p-4 rounded-xl shadow-sm border">
          <div class="flex items-center gap-3">
            <div class="w-10 h-10 rounded-lg bg-red-100 flex items-center justify-center">
              <i class="ri-money-dollar-circle-line text-red-600 text-lg"></i>
            </div>
            <div>
              <p class="text-xs text-gray-500">Ù„Ù‡Ù… Ø¹Ù„ÙŠÙ†Ø§</p>
              <p class="text-lg font-bold text-red-600" id="amount-due">0 Ø¬.Ù…</p>
            </div>
          </div>
        </div>

        <!-- Amount They Owe -->
        <div class="bg-white p-4 rounded-xl shadow-sm border">
          <div class="flex items-center gap-3">
            <div class="w-10 h-10 rounded-lg bg-green-100 flex items-center justify-center">
              <i class="ri-bank-card-line text-green-600 text-lg"></i>
            </div>
            <div>
              <p class="text-xs text-gray-500">Ø¹Ù„ÙŠÙ†Ø§ Ù„Ù‡Ù…</p>
              <p class="text-lg font-bold text-green-600" id="amount-owed">0 Ø¬.Ù…</p>
            </div>
          </div>
        </div>
      </div>

      <!-- BALANCE SUMMARY -->
      <div class="bg-gradient-to-br from-blue-50 to-blue-100 p-6 rounded-xl shadow-sm border-2 border-blue-200 mb-6">
        <p class="text-gray-600 text-sm mb-2">Ø§Ù„Ø±ØµÙŠØ¯ Ø§Ù„Ø­Ø§Ù„ÙŠ</p>
        <p class="text-4xl font-bold text-blue-600" id="balance-summary">0 Ø¬.Ù…</p>
        <p class="text-xs text-gray-500 mt-2" id="balance-status">Ù…ÙˆØ§Ø²Ù†Ø© Ø§Ù„ØµÙØ±</p>
      </div>

      <!-- TRANSACTIONS TABLE -->
      <div class="bg-white rounded-xl shadow-sm border p-4 mb-6">
        <h3 class="font-bold text-lg mb-4 flex items-center gap-2">
          <i class="ri-list-check-2 text-purple-600"></i>
          Ø³Ø¬Ù„ Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø§Øª
        </h3>

        <div class="overflow-x-auto">
          <table class="w-full text-sm">
            <thead>
              <tr class="border-b-2 border-gray-200">
                <th class="text-right p-3 text-gray-600">Ø§Ù„ØªØ§Ø±ÙŠØ®</th>
                <th class="text-right p-3 text-gray-600">Ø§Ù„Ù†ÙˆØ¹</th>
                <th class="text-right p-3 text-gray-600">Ø§Ù„ÙˆØµÙ</th>
                <th class="text-right p-3 text-gray-600">Ø§Ù„Ù…Ø¨Ù„Øº</th>
                <th class="text-center p-3 text-gray-600">Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª</th>
              </tr>
            </thead>
            <tbody id="transactions-table">
              <!-- Will be filled by JS -->
            </tbody>
          </table>
        </div>
      </div>
    </div>
  </main>

  <!-- Floating Action Button -->
  <div class="fab">
    <button onclick="showAddTransactionModal()" 
      class="w-14 h-14 rounded-full bg-purple-600 hover:bg-purple-700 text-white shadow-lg flex items-center justify-center text-xl transition">
      <i class="ri-add-line"></i>
    </button>
  </div>

  <!-- Floating Action Button -->
  <div id="floatingButton"></div>

  <!-- Bottom Navigation -->
  <div id="navbar"></div>

  <!-- Modal Container -->
  <div id="modalContainer"></div>

  <!-- Load common JS -->
  <script src="js/common.js"></script>

  <!-- Page specific script -->
  <script>
    let currentSupplierId = null;

    // Save data when leaving the page
    window.addEventListener('beforeunload', function() {
      if (typeof appData !== 'undefined') {
        saveDataToLocalStorage();
        console.log('ğŸ’¾ ØªÙ… Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù‚Ø¨Ù„ Ø§Ù„Ù…ØºØ§Ø¯Ø±Ø©');
      }
    });

    window.addEventListener('pagehide', function() {
      if (typeof appData !== 'undefined') {
        saveDataToLocalStorage();
        console.log('ğŸ’¾ ØªÙ… Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù‚Ø¨Ù„ Ø§Ù„Ù…ØºØ§Ø¯Ø±Ø© (pagehide)');
      }
    });

    // Get supplier ID from URL
    function getSuppliersIdFromURL() {
      const params = new URLSearchParams(window.location.search);
      return parseInt(params.get('id')) || null;
    }

    // Go back
    function goBack() {
      // Ø¥Ø¹Ø§Ø¯Ø© ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù† data.json Ù‚Ø¨Ù„ Ø§Ù„Ø¹ÙˆØ¯Ø©
      if (typeof loadData === 'function') {
        loadData().then(() => {
          console.log('âœ… ØªÙ… Ø¥Ø¹Ø§Ø¯Ø© ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù† data.json');
          setTimeout(() => window.history.back(), 500);
        });
      } else {
        window.history.back();
      }
    }

    // Initialize page
    function init() {
      currentSupplierId = getSuppliersIdFromURL();
      if (!currentSupplierId) {
        document.getElementById('loading-indicator').innerHTML = '<p class="text-red-500">Ø®Ø·Ø£: Ù„Ù… ÙŠØªÙ… ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ù…ÙˆØ±Ø¯</p>';
        return;
      }

      loadSupplierData();
    }

    // Load supplier data
    function loadSupplierData() {
      const supplier = appData.suppliers.find(s => s.id === currentSupplierId);
      
      if (!supplier) {
        document.getElementById('loading-indicator').innerHTML = '<p class="text-red-500">Ø§Ù„Ù…ÙˆØ±Ø¯ ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯</p>';
        return;
      }

      // Hide loading, show content
      document.getElementById('loading-indicator').classList.add('hidden');
      document.getElementById('content-area').classList.remove('hidden');

      // Update header
      document.getElementById('supplier-name').textContent = supplier.name;
      document.getElementById('supplier-avatar').textContent = supplier.name.charAt(0);

      // Update supplier card
      document.getElementById('supplier-fullname').textContent = supplier.name;
      document.getElementById('supplier-phone').innerHTML = supplier.phone ? 
        `<i class="ri-phone-line text-gray-500 ml-1"></i>${supplier.phone}` : 
        '<span class="text-gray-400">Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù‡Ø§ØªÙ</span>';

      // Count transactions
      document.getElementById('transaction-count').textContent = supplier.transactions.length;

      // Last transaction date
      if (supplier.transactions.length > 0) {
        const lastDate = new Date(supplier.transactions[0].date).toLocaleDateString('ar-EG');
        document.getElementById('last-transaction').textContent = lastDate;
      }

      // Calculate statistics
      let purchased = 0;  // We owe them
      let paid = 0;       // We paid them

      supplier.transactions.forEach(t => {
        if (t.type === 'purchase') {
          purchased += t.amount;
        } else if (t.type === 'payment') {
          paid += t.amount;
        }
      });

      const balance = purchased - paid;

      // Update stat cards
      document.getElementById('amount-due').textContent = purchased.toLocaleString('ar-EG') + ' Ø¬.Ù…';
      document.getElementById('amount-owed').textContent = paid.toLocaleString('ar-EG') + ' Ø¬.Ù…';

      // Update balance with color coding
      const balanceEl = document.getElementById('balance-summary');
      const balanceStatusEl = document.getElementById('balance-status');
      const balanceContainer = document.querySelector('.bg-gradient-to-br');
      
      balanceEl.textContent = Math.abs(balance).toLocaleString('ar-EG') + ' Ø¬.Ù…';
      
      if (balance > 0) {
        balanceStatusEl.textContent = 'Ù†Ø­Ù† Ù…Ø¯ÙŠÙ†ÙˆÙ† Ù„Ù‡Ù… Ø¨Ù‡Ø°Ø§ Ø§Ù„Ù…Ø¨Ù„Øº';
        balanceEl.classList.remove('text-green-600');
        balanceEl.classList.add('text-red-600');
        balanceContainer?.classList.remove('from-blue-50', 'to-blue-100', 'border-blue-200');
        balanceContainer?.classList.add('from-red-50', 'to-red-100', 'border-red-200');
      } else if (balance < 0) {
        balanceStatusEl.textContent = 'Ù‡Ù… Ù…Ø¯ÙŠÙ†ÙˆÙ† Ù„Ù†Ø§ Ø¨Ù‡Ø°Ø§ Ø§Ù„Ù…Ø¨Ù„Øº';
        balanceEl.classList.remove('text-red-600');
        balanceEl.classList.add('text-green-600');
        balanceContainer?.classList.remove('from-blue-50', 'to-blue-100', 'border-blue-200');
        balanceContainer?.classList.add('from-green-50', 'to-green-100', 'border-green-200');
      } else {
        balanceStatusEl.textContent = 'Ù…ÙˆØ§Ø²Ù†Ø© Ø§Ù„ØµÙØ±';
        balanceEl.classList.remove('text-red-600', 'text-green-600');
        balanceEl.classList.add('text-blue-600');
      }

      // Render transactions
      renderTransactions(supplier.transactions);
    }

    // Update page when data is loaded/reloaded
    function updateCurrentPageData() {
      if (currentSupplierId) {
        loadSupplierData();
      }
    }

    // Render transactions table
    function renderTransactions(transactions) {
      const table = document.getElementById('transactions-table');
      table.innerHTML = '';

      if (transactions.length === 0) {
        table.innerHTML = '<tr><td colspan="5" class="p-4 text-center text-gray-500">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ø¹Ø§Ù…Ù„Ø§Øª</td></tr>';
        return;
      }

      transactions
        .sort((a, b) => new Date(b.date) - new Date(a.date))
        .forEach(t => {
          const date = new Date(t.date).toLocaleDateString('ar-EG');
          const typeText = t.type === 'purchase' ? 'Ø´Ø±Ø§Ø¡' : t.type === 'payment' ? 'Ø¯ÙØ¹' : 'Ù…Ø¹Ø§Ù…Ù„Ø©';
          const typeColor = t.type === 'purchase' ? 'bg-red-100 text-red-700' : 'bg-green-100 text-green-700';
          const amountClass = t.type === 'purchase' ? 'text-red-600' : 'text-green-600';

          const row = document.createElement('tr');
          row.className = 'border-b hover:bg-gray-50';
          row.innerHTML = `
            <td class="p-3 text-sm">${date}</td>
            <td class="p-3"><span class="px-3 py-1 rounded-full text-xs font-bold ${typeColor}">${typeText}</span></td>
            <td class="p-3 text-sm">${t.description}</td>
            <td class="p-3 font-bold text-sm ${amountClass}">${t.amount.toLocaleString('ar-EG')} Ø¬.Ù…</td>
            <td class="p-3 text-center">
              <button onclick="deleteTransaction(${t.id})" class="text-red-600 hover:text-red-700 hover:bg-red-50 p-2 rounded-lg transition" title="Ø­Ø°Ù">
                <i class="ri-delete-bin-line"></i>
              </button>
            </td>
          `;
          table.appendChild(row);
        });
    }

    // Show add transaction modal
    function showAddTransactionModal() {
      const supplier = appData.suppliers.find(s => s.id === currentSupplierId);
      
      let modalContent = `
        <h3 class="text-xl font-bold mb-4">Ø¥Ø¶Ø§ÙØ© Ù…Ø¹Ø§Ù…Ù„Ø© - ${supplier.name}</h3>
        
        <form onsubmit="saveTransaction(event)">
          <div class="mb-4">
            <label class="block text-gray-700 mb-2">Ù†ÙˆØ¹ Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø©</label>
            <select required name="transactionType" id="transactionType" class="w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500">
              <option value="">-- Ø§Ø®ØªØ± Ø§Ù„Ù†ÙˆØ¹ --</option>
              <option value="purchase">Ø´Ø±Ø§Ø¡</option>
              <option value="payment">Ø¯ÙØ¹</option>
            </select>
          </div>

          <div class="mb-4">
            <label class="block text-gray-700 mb-2">Ø§Ù„Ù…Ø¨Ù„Øº</label>
            <input type="number" required name="amount" class="w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500">
          </div>

          <div class="mb-4">
            <label class="block text-gray-700 mb-2">Ø§Ù„ÙˆØµÙ</label>
            <div class="relative">
              <input type="text" class="w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500" name="description" id="descriptionInput" oninput="showDescriptionSuggestions()" placeholder="Ø§Ø¨Ø¯Ø£ Ø¨Ø§Ù„ÙƒØªØ§Ø¨Ø© Ù„Ø±Ø¤ÙŠØ© Ø§Ù„Ø§Ù‚ØªØ±Ø§Ø­Ø§Øª">
              <ul id="suggestionsList" class="hidden absolute top-full left-0 right-0 bg-white border border-gray-300 rounded-lg mt-1 max-h-40 overflow-y-auto z-10 shadow-lg"></ul>
            </div>
          </div>

          <div class="flex gap-3">
            <button type="submit" class="flex-1 bg-purple-600 hover:bg-purple-700 text-white py-2 rounded-lg transition">
              Ø¥Ø¶Ø§ÙØ©
            </button>
            <button type="button" onclick="closeModal()" class="flex-1 bg-gray-300 hover:bg-gray-400 text-gray-700 py-2 rounded-lg transition">
              Ø¥Ù„ØºØ§Ø¡
            </button>
          </div>
        </form>
      `;

      showModal(modalContent);
    }

    // Show description suggestions
    function showDescriptionSuggestions() {
      const input = document.getElementById('descriptionInput');
      const query = input.value.toLowerCase().trim();
      const suggestionsList = document.getElementById('suggestionsList');
      
      if (!query || query.length < 1) {
        suggestionsList.classList.add('hidden');
        return;
      }

      // Get existing descriptions from transactions
      const existingDescriptions = new Set();
      appData.suppliers.forEach(supp => {
        supp.transactions.forEach(t => {
          if (t.description) {
            existingDescriptions.add(t.description);
          }
        });
      });

      // Filter matching descriptions
      const suggestions = Array.from(existingDescriptions)
        .filter(desc => desc.toLowerCase().includes(query))
        .slice(0, 5);

      if (suggestions.length > 0) {
        suggestionsList.innerHTML = suggestions
          .map(suggestion => `<li class="px-3 py-2 hover:bg-purple-50 cursor-pointer text-sm" onclick="selectSuggestion('${suggestion.replace(/'/g, "\\'")}')">${suggestion}</li>`)
          .join('');
        suggestionsList.classList.remove('hidden');
      } else {
        suggestionsList.classList.add('hidden');
      }
    }

    // Select suggestion
    function selectSuggestion(suggestion) {
      document.getElementById('descriptionInput').value = suggestion;
      document.getElementById('suggestionsList').classList.add('hidden');
    }

    // Save transaction
    function saveTransaction(event) {
      event.preventDefault();
      const formData = new FormData(event.target);
      const type = formData.get('transactionType');
      const amount = parseFloat(formData.get('amount'));
      const description = formData.get('description');

      if (!type || amount <= 0) {
        showNotification('ÙŠØ±Ø¬Ù‰ Ù…Ù„Ø¡ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„ Ø¨Ø´ÙƒÙ„ ØµØ­ÙŠØ­', 'error');
        return;
      }

      const supplier = appData.suppliers.find(s => s.id === currentSupplierId);
      
      if (!supplier) {
        showNotification('Ø®Ø·Ø£: Ø§Ù„Ù…ÙˆØ±Ø¯ ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯', 'error');
        return;
      }

      const newTransaction = {
        id: Date.now(),
        type: type,
        amount: amount,
        date: new Date().toISOString(),
        description: description || 'Ù…Ø¹Ø§Ù…Ù„Ø© Ø¬Ø¯ÙŠØ¯Ø©',
      };

      supplier.transactions.push(newTransaction);
      console.log('âœ… ØªÙ…Øª Ø¥Ø¶Ø§ÙØ© Ù…Ø¹Ø§Ù…Ù„Ø©:', newTransaction);
      console.log('âœ… Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø§Øª Ø§Ù„Ø­Ø§Ù„ÙŠ:', supplier.transactions.length);

      // Ø­ÙØ¸ Ù…Ø¨Ø§Ø´Ø±Ø© ÙÙŠ data.json ÙˆØ§Ù†ØªØ¸Ø§Ø± Ø§Ù„Ø­ÙØ¸
      if (typeof saveDataToLocalStorage === 'function') {
        saveDataToLocalStorage().then(() => {
          console.log('âœ… Ø§ÙƒØªÙ…Ù„Øª Ø¹Ù…Ù„ÙŠØ© Ø§Ù„Ø­ÙØ¸ ÙÙŠ data.json');
          loadSupplierData();
          closeModal();
          showNotification('ØªÙ…Øª Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø© Ø¨Ù†Ø¬Ø§Ø­', 'success');
        }).catch((error) => {
          console.error('âŒ ÙØ´Ù„ Ø§Ù„Ø­ÙØ¸:', error);
          showNotification('Ø®Ø·Ø£ ÙÙŠ Ø­ÙØ¸ Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø©', 'error');
        });
      }
    }

    // Delete transaction
    function deleteTransaction(transactionId) {
      const supplier = appData.suppliers.find(s => s.id === currentSupplierId);
      const transaction = supplier.transactions.find(t => t.id === transactionId);
      
      if (!transaction) return;
      
      const typeText = transaction.type === 'purchase' ? 'Ø´Ø±Ø§Ø¡' : 'Ø¯ÙØ¹Ø©';
      const confirmMsg = `Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ù‡Ø°Ù‡ Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø©ØŸ\n\nğŸ“‹ Ø§Ù„ØªÙØ§ØµÙŠÙ„:\n- Ø§Ù„Ù†ÙˆØ¹: ${typeText}\n- Ø§Ù„Ù…Ø¨Ù„Øº: ${transaction.amount} Ø¬.Ù…\n- Ø§Ù„ÙˆØµÙ: ${transaction.description}`;
      
      if (confirm(confirmMsg)) {
        supplier.transactions = supplier.transactions.filter(t => t.id !== transactionId);
        
        saveDataToLocalStorage().then(() => {
          loadSupplierData();
          showNotification('ØªÙ… Ø­Ø°Ù Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø© Ø¨Ù†Ø¬Ø§Ø­', 'success');
        });
      }
    }

    // Show modal
    function showModal(content) {
      const modal = document.createElement('div');
      modal.className = 'fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4';
      modal.innerHTML = `
        <div class="bg-white rounded-lg shadow-xl max-w-md w-full p-6 slide-in">
          ${content}
        </div>
      `;
      document.getElementById('modalContainer').appendChild(modal);
    }

    // Close modal
    function closeModal() {
      document.getElementById('modalContainer').innerHTML = '';
    }

    // Load components when DOM is ready
    document.addEventListener('DOMContentLoaded', function() {
      loadComponent('navbar', 'components/navbar.html');
      loadComponent('floatingButton', 'components/floating-button.html');
      
      setTimeout(init, 100);
      
      // Set FAB action for this page - Add transaction
      setTimeout(() => {
        setFabAction(showAddTransactionModal, 'fa-plus', 'purple');
      }, 500);
    });
  </script>
</body>
</html>
